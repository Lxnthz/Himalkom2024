{"version":3,"file":"index.cjs","sources":["index.js"],"sourcesContent":["import { transform, formatMessages } from 'esbuild'\n\nexport function minify({\n  logLevel = 'warning',\n  logLimit = 10,\n  legalComments = 'none',\n  minify = true\n} = {}) {\n  const warn = logLevel !== 'silent' && logLevel !== 'error'\n\n  async function printWarnings(warnings) {\n    const messages = await formatMessages(warnings, { kind: 'warning', color: true })\n    let l = warnings.length\n    /* c8 ignore next 3 */\n    if (logLimit > 0 && logLimit < l) {\n      l = logLimit\n    }\n    for (let i = 0; i < l; ++i) {\n      const { location = {} } = warnings[i]\n      const message = messages[i]\n      this.warn(message, { column: location.column, line: location.line })\n    }\n  }\n\n  return {\n    name: 'esbuild-minify',\n\n    async renderChunk(contents, _, { format, sourcemap }) {\n      const { code, map, warnings } = await transform(contents, {\n        // If the format `cjs` is not provided, module-local variables\n        // will not be minified. Other formats are not affected.\n        format: format === 'cjs' ? 'cjs' : undefined,\n        loader: 'js',\n        minify,\n        legalComments,\n        sourcemap: sourcemap ? 'external' : false,\n        logLevel,\n        logLimit\n      })\n\n      if (warn && warnings.length > 0) {\n        await printWarnings.call(this, warnings)\n      }\n\n      return { code, map: map || null }\n    }\n  }\n}\n"],"names":["formatMessages","transform"],"mappings":";;;;AAEO,SAAS,MAAM,CAAC;AACvB,EAAE,QAAQ,GAAG,SAAS;AACtB,EAAE,QAAQ,GAAG,EAAE;AACf,EAAE,aAAa,GAAG,MAAM;AACxB,EAAE,MAAM,GAAG,IAAI;AACf,CAAC,GAAG,EAAE,EAAE;AACR,EAAE,MAAM,IAAI,GAAG,QAAQ,KAAK,QAAQ,IAAI,QAAQ,KAAK,QAAO;AAC5D;AACA,EAAE,eAAe,aAAa,CAAC,QAAQ,EAAE;AACzC,IAAI,MAAM,QAAQ,GAAG,MAAMA,sBAAc,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,IAAI,EAAE,EAAC;AACrF,IAAI,IAAI,CAAC,GAAG,QAAQ,CAAC,OAAM;AAC3B;AACA,IAAI,IAAI,QAAQ,GAAG,CAAC,IAAI,QAAQ,GAAG,CAAC,EAAE;AACtC,MAAM,CAAC,GAAG,SAAQ;AAClB,KAAK;AACL,IAAI,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,EAAE,CAAC,EAAE;AAChC,MAAM,MAAM,EAAE,QAAQ,GAAG,EAAE,EAAE,GAAG,QAAQ,CAAC,CAAC,EAAC;AAC3C,MAAM,MAAM,OAAO,GAAG,QAAQ,CAAC,CAAC,EAAC;AACjC,MAAM,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,EAAE,MAAM,EAAE,QAAQ,CAAC,MAAM,EAAE,IAAI,EAAE,QAAQ,CAAC,IAAI,EAAE,EAAC;AAC1E,KAAK;AACL,GAAG;AACH;AACA,EAAE,OAAO;AACT,IAAI,IAAI,EAAE,gBAAgB;AAC1B;AACA,IAAI,MAAM,WAAW,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,MAAM,EAAE,SAAS,EAAE,EAAE;AAC1D,MAAM,MAAM,EAAE,IAAI,EAAE,GAAG,EAAE,QAAQ,EAAE,GAAG,MAAMC,iBAAS,CAAC,QAAQ,EAAE;AAChE;AACA;AACA,QAAQ,MAAM,EAAE,MAAM,KAAK,KAAK,GAAG,KAAK,GAAG,SAAS;AACpD,QAAQ,MAAM,EAAE,IAAI;AACpB,QAAQ,MAAM;AACd,QAAQ,aAAa;AACrB,QAAQ,SAAS,EAAE,SAAS,GAAG,UAAU,GAAG,KAAK;AACjD,QAAQ,QAAQ;AAChB,QAAQ,QAAQ;AAChB,OAAO,EAAC;AACR;AACA,MAAM,IAAI,IAAI,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE;AACvC,QAAQ,MAAM,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,QAAQ,EAAC;AAChD,OAAO;AACP;AACA,MAAM,OAAO,EAAE,IAAI,EAAE,GAAG,EAAE,GAAG,IAAI,IAAI,EAAE;AACvC,KAAK;AACL,GAAG;AACH;;;;"}